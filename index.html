<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Wiki - Mon Jeu Roblox</title>

<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#0f172a;
  color:white;
  display:flex;
}

/* ===== HISTOIRE STYLE DISCORD ===== */

.chapter {
  background:#2b2d31;
  border-radius:10px;
  margin-bottom:12px;
  border:1px solid #1f2023;
}

.chapter-header {
  padding:15px;
  cursor:pointer;
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-weight:bold;
  transition:0.2s;
}

.chapter-header:hover{
  background:#313338;
}

.chapter-content{
  max-height:0;
  overflow:hidden;
  transition:all 0.3s ease;
  padding:0 15px;
  color:#cdd6f4;
}

.chapter.active .chapter-content{
  max-height:300px;
  padding:15px;
  border-top:1px solid #1f2023;
  background:#232428;
}

/* ===== SIDEBAR ===== */

.sidebar{
  width:220px;
  background:#111827;
  height:100vh;
  display:flex;
  flex-direction:column;
  padding:20px 0;
}

.sidebar h2{
  text-align:center;
  color:#22d3ee;
  margin-bottom:20px;
}

.menu{
  display:flex;
  flex-direction:column;
  gap:15px;
  padding:0 20px;
}

.menu button{
  background:#1e293b;
  border:none;
  color:white;
  padding:12px;
  border-radius:8px;
  display:flex;
  align-items:center;
  gap:10px;
  cursor:pointer;
  transition:0.2s;
}

.menu button:hover{
  background:#22d3ee;
  color:black;
}

.separator{
  height:1px;
  background:#334155;
  margin:20px 20px;
}

/* ===== MAIN ===== */

.main{
  flex:1;
  display:flex;
  flex-direction:column;
}

header{
  background:#111827;
  padding:15px 30px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.logo{
  font-size:22px;
  font-weight:bold;
  color:#22d3ee;
}

.login-btn{
  background:#5865F2;
  color:white;
  padding:10px 18px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  font-weight:bold;
  display:flex;
  align-items:center;
  gap:8px;
  transition:0.2s;
}

.login-btn:hover{
  background:#4752C4;
}

.container{
  padding:40px;
}

.content-section{
  display:none;
}

.content-section.active{
  display:block;
}

.card, .logs{
  background:#1e293b;
  padding:20px;
  border-radius:12px;
  margin-bottom:20px;
}

.section-image{
  width:100%;
  max-width:500px;
  border-radius:10px;
  margin-top:15px;
}

/* ===== MODAL ===== */
#pseudoModal {
  display:none;
  position:fixed;
  z-index:1000;
  left:0; top:0;
  width:100%; height:100%;
  background:rgba(0,0,0,0.7);
  justify-content:center;
  align-items:center;
}

#pseudoModal .modal-content {
  background:#1e293b;
  padding:30px;
  border-radius:12px;
  text-align:center;
  width:300px;
}

#pseudoModal input {
  padding:10px;
  width:90%;
  border:none;
  border-radius:8px;
  margin-bottom:15px;
}

#pseudoModal button {
  padding:10px 20px;
  background:#5865F2;
  border:none;
  border-radius:8px;
  color:white;
  cursor:pointer;
}

.zoom-container {
  width:100%;
  max-width:800px;
  height:500px;
  overflow:hidden;
  border-radius:10px;
  cursor:grab;
  position:relative;
}

.zoom-image {
  width:100%;
  transition: transform 0.1s ease;
  transform-origin: center center;
  user-select:none;
}
</style>
</head>

<body>

<!-- ===== SIDEBAR ===== -->
<div class="sidebar">
  <h2>Wiki</h2>

  <div class="menu">
    <button onclick="showSection('accueil')">
      <i class="fa-solid fa-house"></i> Accueil
    </button>
  </div>

  <div class="separator"></div>

  <div class="menu">
    <button onclick="showSection('histoire')">
      <i class="fa-solid fa-book"></i> Wiki
    </button>

    <button onclick="showSection('armes')">
      <i class="fa-solid fa-box-open"></i> Items
    </button>

    <button onclick="showSection('carte')">
      <i class="fa-solid fa-map"></i> Carte
    </button>

    <button onclick="showSection('logs')">
      <i class="fa-solid fa-code"></i> Logs
    </button>

    <button onclick="showSection('communaute')">
      <i class="fa-solid fa-users"></i> Communauté
    </button>

    <button onclick="showSection('discord')">
      <i class="fa-brands fa-discord"></i> Discord
    </button>
  </div>
</div>

<!-- ===== MAIN ===== -->
<div class="main">

<header>
  <div class="logo">Wiki ParisRP</div>
  <button class="login-btn" onclick="checkDiscordLogin()">
      <i class="fa-solid fa-user"></i>
      Connexion
  </button>
</header>

<div class="container">

  <!-- ACCUEIL -->
  <div id="accueil" class="content-section active">
    <div class="card">
      <h1>Bienvenue</h1>
      <p>Bienvenue sur le wiki officiel de notre jeu Roblox.</p>
    </div>
  </div>

  <!-- HISTOIRE -->
  <div id="histoire" class="content-section">
    <div class="card">
      <h1>Wiki</h1>

      <div class="chapter" onclick="toggleChapter(this)">
        <div class="chapter-header">
          Chapitre 1 — Créer un serveur privé
          <i class="fa-solid fa-chevron-down"></i>
        </div>
        <div class="chapter-content">
allez sur la page du jeu, cliquez sur l'onglet "Serveurs", puis "Créer un serveur privé.

  Créez un serveur discord ajoutez les en amis et faites des séences de jeux
        </div>
      </div>

      <div class="chapter" onclick="toggleChapter(this)">
        <div class="chapter-header">
          Chapitre 2 — Les bugs
          <i class="fa-solid fa-chevron-down"></i>
        </div>
        <div class="chapter-content">
          Une guerre secrète éclata dans les territoires nord...
        </div>
      </div>

      <div class="chapter" onclick="toggleChapter(this)">
        <div class="chapter-header">
          Chapitre 3 — mince ma question n' est pas ici...
          <i class="fa-solid fa-chevron-down"></i>
        </div>
        <div class="chapter-content">
        Pas de panique il te suffit de rejoindre le support dans "Communauté"
        </div>
      </div>

    </div>
  </div>

  <!-- ITEMS -->
  <div id="armes" class="content-section">
    <div class="card">
      <h1>Items</h1>
      <p>Voici la liste complète des items disponibles :</p>
      <p>1. Les armes</p>
      <p>2. Les véhicules</p>
    </div>
  </div>

  <!-- CARTE -->
  <div id="carte" class="content-section">
    <div class="card">
      <h1>Carte</h1>
      <p>Description des zones importantes.</p>
     
<div class="zoom-container">
  <img src="https://github.com/bot471912-dot/paris-rp/blob/main/carte.png" class="zoom-image" id="zoomImage">
</div>
    </div>
  </div>

  <!-- LOGS -->
  <div id="logs" class="content-section">
    <div class="logs">
      <h1>Logs</h1>
      <p>Incidents & bugs reportés</p>
      <p>-----------------------------------</p>
      <p>- Bug crasch :résolu</p>
    </div>
  </div>

  <!-- COMMUNAUTE -->
  <div id="communaute" class="content-section">
    <div class="card">
      <h1>Communauté</h1>
      <p>Rejoins notre communauté et participe aux événements.</p>
     
     <a href="https://discord.gg/e9STGdPmMD">Support</a>
 <p>ou</p>
     <a href="https://discord.gg/57AT3edZbf">Serveur principale</a>
    </div>
  </div>

  <!-- DISCORD -->
  <div id="discord" class="content-section">
  <div class="card">
    <h1>Discord</h1>
    <p>Connexion requise</p>
  </div>
</div>

    </div>
  </div>

</div>
</div>



<script>

async function checkDiscordLogin() {
  const params = new URLSearchParams(window.location.search);
  const code = params.get("code");
  if (!code) return; // pas de login

  try {
    const response = await fetch(`/callback?code=${code}`);
    const user = await response.json();

    const discordCard = document.querySelector("#discord .card");
    discordCard.innerHTML = `
      <h1>Discord</h1>
      <p>Bienvenue <strong>${user.username}#${user.discriminator}</strong></p>
      <img src="https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png" width="80" style="border-radius:50%;">
    `;
  } catch (err) {
    console.error("Erreur front Discord:", err);
  }
}

// Appel au chargement



// ===============================
// ✅ CONNEXION DISCORD OAUTH2
// ===============================

async function checkDiscordLogin() {
  const params = new URLSearchParams(window.location.search);
  const code = params.get("code");

  if (!code) {
    // Redirection vers Discord OAuth2
    const oauthURL = `=${encodeURIComponent("")}&response_type=code&scope=identify`;
    window.location.href = oauthURL;
    return;
  }

  try {
    const response = await fetch(`/callback?code=${code}`);
    const user = await response.json();

    const discordCard = document.querySelector("#discord .card");
    discordCard.innerHTML = `
      <h1>Discord</h1>
      <p>Bienvenue <strong>${user.username}#${user.discriminator}</strong></p>
      <img src="https://cdn.discordapp.com/avatars/${user.id}/${user.avatar}.png" width="80" style="border-radius:50%;">
    `;

    // Nettoie l'URL pour ne plus afficher le code
    window.history.replaceState({}, document.title, "/");
  } catch (err) {
    console.error("Erreur front Discord:", err);
  }
}

// Appel au chargement
checkDiscordLogin();
// ===============================
// ✅ ZOOM IMAGE (sécurisé)
// ===============================

const zoomImage = document.getElementById("zoomImage");

if (zoomImage) {

  let scale = 1;
  let isDragging = false;
  let startX, startY;
  let currentX = 0, currentY = 0;

  zoomImage.parentElement.addEventListener("wheel", (e) => {
    e.preventDefault();
    const delta = e.deltaY > 0 ? -0.1 : 0.1;
    scale += delta;
    if (scale < 0.5) scale = 0.5;
    if (scale > 5) scale = 5;
    zoomImage.style.transform = `translate(${currentX}px, ${currentY}px) scale(${scale})`;
  });

  zoomImage.addEventListener("mousedown", (e) => {
    e.preventDefault();
    isDragging = true;
    startX = e.clientX - currentX;
    startY = e.clientY - currentY;
    zoomImage.style.cursor = "grabbing";
  });

  document.addEventListener("mousemove", (e) => {
    if (!isDragging) return;
    currentX = e.clientX - startX;
    currentY = e.clientY - startY;
    zoomImage.style.transform = `translate(${currentX}px, ${currentY}px) scale(${scale})`;
  });

  document.addEventListener("mouseup", () => {
    isDragging = false;
    zoomImage.style.cursor = "grab";
  });

  zoomImage.addEventListener("touchstart", (e) => {
    if(e.touches.length === 1){
      isDragging = true;
      startX = e.touches[0].clientX - currentX;
      startY = e.touches[0].clientY - currentY;
    }
  });

  zoomImage.addEventListener("touchmove", (e) => {
    if(!isDragging || e.touches.length !== 1) return;
    currentX = e.touches[0].clientX - startX;
    currentY = e.touches[0].clientY - startY;
    zoomImage.style.transform = `translate(${currentX}px, ${currentY}px) scale(${scale})`;
  });

  zoomImage.addEventListener("touchend", () => {
    isDragging = false;
  });

}

// ===============================
// ✅ NAVIGATION
// ===============================

function toggleChapter(element){
  document.querySelectorAll(".chapter").forEach(ch => {
    if(ch !== element){
      ch.classList.remove("active");
    }
  });
  element.classList.toggle("active");
}

function showSection(sectionId){
  document.querySelectorAll('.content-section').forEach(section => {
    section.classList.remove('active');
  });
  const activeSection = document.getElementById(sectionId);
  if(activeSection){
    activeSection.classList.add('active');
  }
}

</script>

</body>
</html>






